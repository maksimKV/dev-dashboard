import{a as V,d as q,e as J,h as G,i as U,l as Y,m as H}from"./chunk-QT7LVH2V.js";import{b as O,f as T,g as L,h as R,i as E,j as B,k as N,m as z,n as j,p as A}from"./chunk-NOONISSY.js";import{b as W}from"./chunk-VABHDXPX.js";import{$a as n,Ab as _,Ca as a,Ga as d,Hb as I,Ib as y,La as u,Qc as p,Rc as h,Ub as C,_a as k,ab as i,bb as S,ec as x,fc as F,gb as c,gc as P,tb as w,vb as r,wb as f,xa as D,xb as b,yb as v,zb as M}from"./chunk-TX3JR46X.js";var g=class m{constructor(o,t,e){this.platformId=o;this.cdr=t;this.authService=e;this.isBrowser=P(this.platformId)}workDuration=25;breakDuration=5;timeLeft=this.workDuration*60;isRunning=!1;isWork=!0;intervalId=null;completedFocusSessions=0;totalWorkSeconds=0;isBrowser;isLoading=!1;ngOnInit(){this.isBrowser&&this.loadState()}get minutes(){return Math.floor(this.timeLeft/60).toString().padStart(2,"0")}get seconds(){return(this.timeLeft%60).toString().padStart(2,"0")}start(){this.isRunning||(this.isRunning=!0,this.intervalId=setInterval(()=>{this.timeLeft>0?(this.timeLeft--,this.isWork&&this.totalWorkSeconds++):(this.isRunning=!1,this.intervalId&&clearInterval(this.intervalId),this.isWork?(this.completedFocusSessions++,this.isWork=!1,this.timeLeft=this.breakDuration*60):(this.isWork=!0,this.timeLeft=this.workDuration*60),this.saveState(),this.start()),this.saveState(),this.cdr.markForCheck()},1e3))}pause(){this.isRunning=!1,this.intervalId&&clearInterval(this.intervalId),this.saveState()}reset(){this.isRunning=!1,this.intervalId&&clearInterval(this.intervalId),this.timeLeft=this.isWork?this.workDuration*60:this.breakDuration*60,this.saveState()}updateDurations(){this.isWork?this.timeLeft=this.workDuration*60:this.timeLeft=this.breakDuration*60,this.saveState()}saveState(){if(!this.isBrowser)return;let o={workDuration:this.workDuration,breakDuration:this.breakDuration,timeLeft:this.timeLeft,isRunning:this.isRunning,isWork:this.isWork,completedFocusSessions:this.completedFocusSessions,totalWorkSeconds:this.totalWorkSeconds};this.authService.updateFocusTimer(o).subscribe({next:()=>{},error:t=>{console.error("Failed to save timer state:",t),localStorage.setItem("focus-timer",JSON.stringify(o))}})}loadState(){this.isBrowser&&(this.isLoading=!0,this.authService.getUserData().subscribe({next:o=>{let t=o.focusTimer||{};this.workDuration=t.workDuration??25,this.breakDuration=t.breakDuration??5,this.timeLeft=t.timeLeft??this.workDuration*60,this.isRunning=!1,this.isWork=t.isWork??!0,this.completedFocusSessions=t.completedFocusSessions??0,this.totalWorkSeconds=t.totalWorkSeconds??0,this.isLoading=!1,this.cdr.detectChanges()},error:o=>{console.error("Failed to load timer state from API:",o);let t=localStorage.getItem("focus-timer");if(t)try{let e=JSON.parse(t);this.workDuration=e.workDuration??25,this.breakDuration=e.breakDuration??5,this.timeLeft=e.timeLeft??this.workDuration*60,this.isRunning=!1,this.isWork=e.isWork??!0,this.completedFocusSessions=e.completedFocusSessions??0,this.totalWorkSeconds=e.totalWorkSeconds??0}catch(e){this.workDuration=25,this.breakDuration=5,this.timeLeft=25*60,this.isRunning=!1,this.isWork=!0,this.completedFocusSessions=0,this.totalWorkSeconds=0,console.error("Failed to parse focus-timer data:",e)}this.isLoading=!1,this.cdr.detectChanges()}}))}ngOnDestroy(){this.intervalId&&clearInterval(this.intervalId)}static \u0275fac=function(t){return new(t||m)(d(D),d(C),d(W))};static \u0275cmp=u({type:m,selectors:[["app-focus-timer"]],decls:37,vars:14,consts:[[1,"focus-timer"],[1,"settings",3,"ngSubmit"],["appearance","outline"],["matInput","","type","number","min","1","name","workDuration","required","",3,"ngModelChange","ngModel"],["matInput","","type","number","min","1","name","breakDuration","required","",3,"ngModelChange","ngModel"],["mat-raised-button","","color","primary","type","submit"],[1,"timer-display"],[1,"minutes"],[1,"seconds"],[1,"interval-label"],[1,"controls"],["mat-raised-button","","color","primary",3,"click","disabled"],["mat-raised-button","","color","accent",3,"click","disabled"],["mat-raised-button","","color","warn",3,"click"],[1,"stats"]],template:function(t,e){t&1&&(n(0,"div",0)(1,"form",1),c("ngSubmit",function(){return e.updateDurations()}),n(2,"mat-form-field",2)(3,"mat-label"),r(4,"Work (min)"),i(),n(5,"input",3),_("ngModelChange",function(s){return M(e.workDuration,s)||(e.workDuration=s),s}),i()(),n(6,"mat-form-field",2)(7,"mat-label"),r(8,"Break (min)"),i(),n(9,"input",4),_("ngModelChange",function(s){return M(e.breakDuration,s)||(e.breakDuration=s),s}),i()(),n(10,"button",5),r(11,"Set"),i()(),n(12,"div",6)(13,"span",7),r(14),i(),r(15,":"),n(16,"span",8),r(17),i(),n(18,"div",9),r(19),i()(),n(20,"div",10)(21,"button",11),c("click",function(){return e.start()}),r(22,"Start"),i(),n(23,"button",12),c("click",function(){return e.pause()}),r(24,"Pause"),i(),n(25,"button",13),c("click",function(){return e.reset()}),r(26,"Reset"),i()(),n(27,"div",14)(28,"div")(29,"mat-icon"),r(30,"check_circle"),i(),r(31),i(),n(32,"div")(33,"mat-icon"),r(34,"timer"),i(),r(35),I(36,"number"),i()()()),t&2&&(a(5),v("ngModel",e.workDuration),a(4),v("ngModel",e.breakDuration),a(3),w("break",!e.isWork),a(2),f(e.minutes),a(3),f(e.seconds),a(2),f(e.isWork?"Work":"Break"),a(2),k("disabled",e.isRunning),a(2),k("disabled",!e.isRunning),a(8),b(" Focus Sessions: ",e.completedFocusSessions),a(4),b(" Time worked: ",y(36,11,e.totalWorkSeconds/60,"1.0-0")," min"))},dependencies:[F,x,A,B,O,N,T,L,j,z,E,R,H,Y,J,q,V,U,G,h,p],styles:[".focus-timer[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:2rem;max-width:400px;margin:0 auto}.settings[_ngcontent-%COMP%]{display:flex;gap:1rem;width:100%;justify-content:center}.timer-display[_ngcontent-%COMP%]{font-size:3rem;font-weight:600;color:#3f51b5;background:#f5f5f5;border-radius:1rem;padding:1.5rem 2.5rem;box-shadow:0 2px 8px #0000000a;display:flex;flex-direction:column;align-items:center;min-width:220px}.timer-display.break[_ngcontent-%COMP%]{color:#43a047}.interval-label[_ngcontent-%COMP%]{font-size:1.1rem;margin-top:.5rem;color:#888}.controls[_ngcontent-%COMP%]{display:flex;gap:1rem}.stats[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem;align-items:flex-start;color:#555;font-size:1.1rem}.stats[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{vertical-align:middle;margin-right:.3rem;color:#3f51b5}@media (max-width: 600px){.focus-timer[_ngcontent-%COMP%]{max-width:100%;padding:0 1rem}.timer-display[_ngcontent-%COMP%]{min-width:0;padding:1rem;font-size:2.2rem}.settings[_ngcontent-%COMP%]{flex-direction:column;align-items:stretch}}"]})};var K=class m{static \u0275fac=function(t){return new(t||m)};static \u0275cmp=u({type:m,selectors:[["app-timer-page"]],decls:6,vars:0,consts:[[1,"feature-card"],[1,"feature-card-header"],["fontIcon","timer"]],template:function(t,e){t&1&&(n(0,"div",0)(1,"div",1),S(2,"mat-icon",2),n(3,"h1"),r(4,"Focus Timer"),i()(),S(5,"app-focus-timer"),i())},dependencies:[g,h,p],styles:[".feature-card[_ngcontent-%COMP%]{max-width:540px;margin:2.5rem auto 0;background:#fff;border-radius:18px;box-shadow:0 4px 24px #00000014,0 1.5px 6px #0000000a;padding:2.5rem 2.5rem 2rem;animation:_ngcontent-%COMP%_fadeIn .7s cubic-bezier(.4,0,.2,1)}.feature-card-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.9rem;margin-bottom:1.5rem}.feature-card-header[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:2.2rem;height:2.2rem;width:2.2rem;min-width:2.2rem;min-height:2.2rem;color:#1976d2;display:flex;align-items:center;justify-content:center;line-height:1;vertical-align:middle;position:relative;top:0}.feature-card-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:1.7rem;font-weight:700;margin:0;color:#222}@media (max-width: 700px){.feature-card[_ngcontent-%COMP%]{padding:1.2rem .7rem;max-width:98vw}.feature-card-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:1.1rem}}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:translateY(30px)}to{opacity:1;transform:none}}"]})};export{K as TimerPage};
