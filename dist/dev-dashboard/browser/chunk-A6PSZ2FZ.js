import{a as G,d as H,e as U,h as Y,i as K,l as Q,m as X}from"./chunk-EKFB2DP4.js";import{b as R,f as N,g as E,h as A,i as B,j as z,k as j,m as V,n as q,p as J}from"./chunk-CSTJYM27.js";import{b as L}from"./chunk-6QMKKLVS.js";import{$a as p,Ab as M,Bb as _,Da as s,Ha as u,Ib as C,Jb as x,Ma as f,Qa as y,Uc as h,Vb as P,Vc as g,ab as n,bb as i,cb as S,dc as F,fc as W,gc as O,hb as c,hc as T,ib as D,ub as I,wb as r,xb as d,ya as w,yb as b,zb as v}from"./chunk-KKF36AK5.js";function ie(a,o){if(a&1&&(n(0,"div",16),r(1),i()),a&2){let e=D();s(),d(e.errorMessage)}}var k=class a{constructor(o,e,t){this.platformId=o;this.cdr=e;this.authService=t;this.isBrowser=T(this.platformId)}workDuration=25;breakDuration=5;timeLeft=this.workDuration*60;isRunning=!1;isWork=!0;intervalId=null;completedFocusSessions=0;totalWorkSeconds=0;isBrowser;isLoading=!1;finishAudio=null;errorMessage="";ngOnInit(){this.isBrowser&&(this.loadState(),this.finishAudio=new Audio("/timer-finish.mp3"),"Notification"in window&&Notification.permission==="default"&&Notification.requestPermission())}get minutes(){return Math.floor(this.timeLeft/60).toString().padStart(2,"0")}get seconds(){return(this.timeLeft%60).toString().padStart(2,"0")}start(){this.isRunning||(this.isRunning=!0,this.intervalId=setInterval(()=>{this.timeLeft>0?(this.timeLeft--,this.isWork&&this.totalWorkSeconds++):(this.isRunning=!1,this.intervalId&&clearInterval(this.intervalId),this.notifyFinish(),this.isWork?(this.completedFocusSessions++,this.isWork=!1,this.timeLeft=this.breakDuration*60):(this.isWork=!0,this.timeLeft=this.workDuration*60),this.saveState(),this.start()),this.saveState(),this.cdr.markForCheck()},1e3))}pause(){this.isRunning=!1,this.intervalId&&clearInterval(this.intervalId),this.saveState()}reset(){this.isRunning=!1,this.intervalId&&clearInterval(this.intervalId),this.timeLeft=this.isWork?this.workDuration*60:this.breakDuration*60,this.saveState()}updateDurations(){this.isWork?this.timeLeft=this.workDuration*60:this.timeLeft=this.breakDuration*60,this.saveState()}saveState(){if(!this.isBrowser)return;let o={workDuration:this.workDuration,breakDuration:this.breakDuration,timeLeft:this.timeLeft,isRunning:this.isRunning,isWork:this.isWork,completedFocusSessions:this.completedFocusSessions,totalWorkSeconds:this.totalWorkSeconds};this.authService.updateFocusTimer(o).subscribe({next:()=>{},error:()=>{localStorage.setItem("focus-timer",JSON.stringify(o))}})}loadState(){this.isBrowser&&(this.isLoading=!0,this.errorMessage="",this.authService.getUserData().subscribe({next:o=>{let e=o.focusTimer||{};this.workDuration=e.workDuration??25,this.breakDuration=e.breakDuration??5,this.timeLeft=e.timeLeft??this.workDuration*60,this.isRunning=!1,this.isWork=e.isWork??!0,this.completedFocusSessions=e.completedFocusSessions??0,this.totalWorkSeconds=e.totalWorkSeconds??0,this.isLoading=!1,this.cdr.detectChanges()},error:()=>{let o=localStorage.getItem("focus-timer");if(o)try{let e=JSON.parse(o);this.workDuration=e.workDuration??25,this.breakDuration=e.breakDuration??5,this.timeLeft=e.timeLeft??this.workDuration*60,this.isRunning=!1,this.isWork=e.isWork??!0,this.completedFocusSessions=e.completedFocusSessions??0,this.totalWorkSeconds=e.totalWorkSeconds??0}catch{this.workDuration=25,this.breakDuration=5,this.timeLeft=25*60,this.isRunning=!1,this.isWork=!0,this.completedFocusSessions=0,this.totalWorkSeconds=0,this.errorMessage="Could not load your timer state from API or local storage."}else this.workDuration=25,this.breakDuration=5,this.timeLeft=25*60,this.isRunning=!1,this.isWork=!0,this.completedFocusSessions=0,this.totalWorkSeconds=0,this.errorMessage="Could not load your timer state from API or local storage.";this.isLoading=!1,this.cdr.detectChanges()}}))}ngOnDestroy(){this.intervalId&&clearInterval(this.intervalId)}notifyFinish(){if(this.finishAudio){let o=0,e=6,t=()=>{this.finishAudio&&(this.finishAudio.currentTime=0,this.finishAudio.play(),o++,o<e&&setTimeout(t,400))};t()}this.isBrowser&&"Notification"in window&&Notification.permission==="granted"&&new Notification("Focus Timer",{body:this.isWork?"Work session finished!":"Break finished!"})}static \u0275fac=function(e){return new(e||a)(u(w),u(P),u(L))};static \u0275cmp=f({type:a,selectors:[["app-focus-timer"]],decls:38,vars:15,consts:[[1,"focus-timer"],[1,"settings",3,"ngSubmit"],["appearance","outline"],["matInput","","type","number","min","1","name","workDuration","required","",3,"ngModelChange","ngModel"],["matInput","","type","number","min","1","name","breakDuration","required","",3,"ngModelChange","ngModel"],["mat-raised-button","","color","primary","type","submit"],["class","error-message",4,"ngIf"],[1,"timer-display"],[1,"minutes"],[1,"seconds"],[1,"interval-label"],[1,"controls"],["mat-raised-button","","color","primary",3,"click","disabled"],["mat-raised-button","","color","accent",3,"click","disabled"],["mat-raised-button","","color","warn",3,"click"],[1,"stats"],[1,"error-message"]],template:function(e,t){e&1&&(n(0,"div",0)(1,"form",1),c("ngSubmit",function(){return t.updateDurations()}),n(2,"mat-form-field",2)(3,"mat-label"),r(4,"Work (min)"),i(),n(5,"input",3),_("ngModelChange",function(m){return M(t.workDuration,m)||(t.workDuration=m),m}),i()(),n(6,"mat-form-field",2)(7,"mat-label"),r(8,"Break (min)"),i(),n(9,"input",4),_("ngModelChange",function(m){return M(t.breakDuration,m)||(t.breakDuration=m),m}),i()(),n(10,"button",5),r(11,"Set"),i()(),y(12,ie,2,1,"div",6),n(13,"div",7)(14,"span",8),r(15),i(),r(16,":"),n(17,"span",9),r(18),i(),n(19,"div",10),r(20),i()(),n(21,"div",11)(22,"button",12),c("click",function(){return t.start()}),r(23,"Start"),i(),n(24,"button",13),c("click",function(){return t.pause()}),r(25,"Pause"),i(),n(26,"button",14),c("click",function(){return t.reset()}),r(27,"Reset"),i()(),n(28,"div",15)(29,"div")(30,"mat-icon"),r(31,"check_circle"),i(),r(32),i(),n(33,"div")(34,"mat-icon"),r(35,"timer"),i(),r(36),C(37,"number"),i()()()),e&2&&(s(5),v("ngModel",t.workDuration),s(4),v("ngModel",t.breakDuration),s(3),p("ngIf",t.errorMessage),s(),I("break",!t.isWork),s(2),d(t.minutes),s(3),d(t.seconds),s(2),d(t.isWork?"Work":"Break"),s(2),p("disabled",t.isRunning),s(2),p("disabled",!t.isRunning),s(8),b(" Focus Sessions: ",t.completedFocusSessions),s(4),b(" Time worked: ",x(37,12,t.totalWorkSeconds/60,"1.0-0")," min"))},dependencies:[O,F,W,J,z,R,j,N,E,q,V,B,A,X,Q,U,H,G,K,Y,g,h],styles:[".focus-timer[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:2rem;max-width:400px;margin:0 auto}.settings[_ngcontent-%COMP%]{display:flex;gap:1rem;width:100%;justify-content:center}.timer-display[_ngcontent-%COMP%]{font-size:3rem;font-weight:600;color:#3f51b5;background:#f5f5f5;border-radius:1rem;padding:1.5rem 2.5rem;box-shadow:0 2px 8px #0000000a;display:flex;flex-direction:column;align-items:center;min-width:220px}.timer-display.break[_ngcontent-%COMP%]{color:#43a047}.interval-label[_ngcontent-%COMP%]{font-size:1.1rem;margin-top:.5rem;color:#888}.controls[_ngcontent-%COMP%]{display:flex;gap:1rem}.stats[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem;align-items:flex-start;color:#555;font-size:1.1rem}.stats[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{vertical-align:middle;margin-right:.3rem;color:#3f51b5}@media (max-width: 600px){.focus-timer[_ngcontent-%COMP%]{max-width:100%;padding:0 1rem}.timer-display[_ngcontent-%COMP%]{min-width:0;padding:1rem;font-size:2.2rem}.settings[_ngcontent-%COMP%]{flex-direction:column;align-items:stretch}}"]})};var Z=class a{static \u0275fac=function(e){return new(e||a)};static \u0275cmp=f({type:a,selectors:[["app-timer-page"]],decls:6,vars:0,consts:[[1,"feature-card"],[1,"feature-card-header"],["fontIcon","timer"]],template:function(e,t){e&1&&(n(0,"div",0)(1,"div",1),S(2,"mat-icon",2),n(3,"h1"),r(4,"Focus Timer"),i()(),S(5,"app-focus-timer"),i())},dependencies:[k,g,h],styles:[".feature-card[_ngcontent-%COMP%]{max-width:540px;margin:2.5rem auto 0;background:#fff;border-radius:18px;box-shadow:0 4px 24px #00000014,0 1.5px 6px #0000000a;padding:2.5rem 2.5rem 2rem;animation:_ngcontent-%COMP%_fadeIn .7s cubic-bezier(.4,0,.2,1)}.feature-card-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.9rem;margin-bottom:1.5rem}.feature-card-header[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:2.2rem;height:2.2rem;width:2.2rem;min-width:2.2rem;min-height:2.2rem;color:#1976d2;display:flex;align-items:center;justify-content:center;line-height:1;vertical-align:middle;position:relative;top:0}.feature-card-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:1.7rem;font-weight:700;margin:0;color:#222}@media (max-width: 700px){.feature-card[_ngcontent-%COMP%]{padding:1.2rem .7rem;max-width:98vw}.feature-card-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:1.1rem}}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:translateY(30px)}to{opacity:1;transform:none}}"]})};export{Z as TimerPage};
